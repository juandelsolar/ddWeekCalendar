<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="js/libs/jquery-1.8.0/jquery.js"></script>
        <script type="text/javascript" src="js/libs/ddWeekCalendar/ddWeekCalendar.js"></script>
        <script type="text/javascript" src="js/libs/ddWeekCalendar/datejs/build/date-es-CL.js"></script>
        <!--<link rel="stylesheet" href="js/libs/redips/style.css" type="text/css" media="screen" />-->
        <!--<script type="text/javascript" src="js/libs/redips/header.js"></script>-->
        <script type="text/javascript" src="js/libs/redips/redips-drag-min.js"></script>
        <link href="style/style.css" rel="stylesheet" type="text/css"/>
	<link rel="SHORTCUT ICON" href="image/favicon.ico">
        <script>
            $(document).ready(function() {
                var isDragging = false;
                var calendar = new ddWeekCalendar('12-11-2012', '17-11-2012', '08:00', '20:00', 5);
                calendar.draw('calendar');
                /* test cases */
                calendar.addSchedule('13-11-2012', '09:00', '13:00', '#ffeeff', 'Doctor Del Solar')
                calendar.addSchedule('15-11-2012', '13:00', '15:30', '#f00', 'Doctora Zuniga')
                calendar.addEvent('12-11-2012', '10:00', 1, 30, 'Event')
                REDIPS.drag.init();
                $(".drag")
                .mousedown(function(e){
                    //id = e.currentTarget.id;
                    idEvent = e.target.offsetParent.id;
                    var nEvent = idEvent.split("_");
                    var dateEvent = nEvent[0];
                    var hourEvent = nEvent[1];
                    eventSpan = document.getElementById(idEvent).rowSpan;
                    //console.log(document.getElementById(id).rowSpan);
                    $(window).mousemove(function() {
                        isDragging = true;
                        $(window).unbind("mousemove");
                        id = e.target.offsetParent.id;
                        var n = id.split("_");
                        var date = n[0];
                        var hour = n[1];
                        var duration = eventSpan * 5;
                        document.getElementById(idEvent).rowSpan = 1;
                        calendar.updateEvent(date, hour, 20, duration, 'Event', dateEvent)
                        console.log(duration);
                    });

                })
                .mouseup(function(e){
                    var wasDragging = isDragging;
                    isDragging = false;
                    $(window).unbind("mousemove");
                    //id = e.currentTarget.id;
                    id = e.target.offsetParent.id;
                });
            });
        </script>
    </head>
    <body>
        <div id="drag">
            <div id="calendar"></div>
            <div id="events"></div>
        </div>
    </body>
</html>
